OPTIČNE KOMUNIKACIJE
--------------------------------------------------------------------------------
- vsepovsod v elektroniki:
    - dljinec za TV
    - internetne povezave
    - IR merjenje razdalj
    - lasersko merjenje hitrosti
    - senzor za dež

###  Svetlobni izvor 

- svetleče diode
- Ee = Ef --> eU = h c/a

- $e_0$ - osnovni naboj $e_0=1.6\ 10^{-19} C$
- $c$ - svetlobna hitrost $c=3.0\ 10^{8}\frac{m}{s}$
- $h$ - Planckova konstanta $h=6.6\ 10^{-34}Js$

### Svetlobni izvor

Svetleče diode (LED) so polprevodniški viri svetlobe, pri katerih rekombinacija elektronov in lukenj v polprevodniku sprošča svetlobno energijo v obliki fotonov. Osvetlimo lahko dve pomembni lastnosti LED diod: valovno dolžino svetlobe, ki jo oddajajo, in svetilnost.

#### Valovna dolžina svetlobe LED

Valovna dolžina svetlobe, ki jo oddaja LED, je določena z energijo fotonov, ki nastanejo pri prehodu elektronov skozi p-n prehod v polprevodniku. Ta energija je neposredno povezana z napetostjo, ki se uporablja preko LED, znano kot kolenska napetost $ U $.

Energija prenosa elektronov je povezana z energijo fotonov s sledečo enačbo:

$$ eU = \frac{hc}{\lambda} $$

Kjer:

- $e$ je osnovni naboj elektrona $e_0 = 1.6 \times 10^{-19} \, \text{C}$
- $U$ je kolenska napetost, napetost, kjer LED začne prevajati. To napetost razdelilni sistem narekuje kot fiksno.
- $h$ je Planckova konstanta $h = 6.6 \times 10^{-34} \, \text{Js}$
- $c$ je hitrost svetlobe $c = 3.0 \times 10^{8} \, \text{m/s}$
- $\lambda$ je valovna dolžina svetlobe

Ta odnos dokazuje, da je valovna dolžina $\lambda$ odvisna zgolj od kolenske napetosti $U$. Z večanjem te napetosti zmanjša valovna dolžina, kar povzroča potencialno prehod svetlobe v krajše valovne dolžine (npr. od rdeče proti modri).

#### Svetilnost LED

Svetilnost, ali moč svetlobe, ki jo LED oddaja, je neposredno odvisna od električnega toka $I$, ki teče skozi napravo. Svetilna moč je posledica števila elektronov, ki se rekombinirajo, kar je opisano z naslednjo enačbo:

$$ P = I \cdot U $$
$$equation$${#eq:eq_reference}
Kjer:

- $P$ je svetlobna moč ali svetilnost, izražena v vatih
- $I$ je električni tok skozi diode
- $U$ je napetost, pogosto konstantna kolenska napetost v našem pogledu

Zanemarjajoč dodatni električni upor sistema, v katerem je LED vgrajena, iz zgornje enačbe sledi, da svetilnost LED povečuje z večanjem toka $I$. Tok določa število elektronov, ki se rekombinirajo v LED in posledično število oddanih fotonov, kar vodi do večje intenzivnosti svetlobe.

Ti temeljni fizikalni odnosi omogočajo načrtovanje svetlečih diod za specifične aplikacije in barvne temperature, tako da ustrezno uravnavamo kolensko napetost in električni tok.

#### Krmiljenje svetlobnega izvora z Darlingtonovim tranzistorjem

Darlingtonovo vezje se uporablja kot visokonapetostni in visokotokovni vmesnik med krmilnimi logičnimi izhodi in obremenitvami — npr. releji, elektromagneti in motorji — kjer je potreben velik tokovni ojačevalnik pri minimalnem vhodnem signalu. V konfiguraciji z odprtim kolektorjem (open-collector) nudi varno prekinjanje napajanja obremenitve in enostavno vezavo na skupno napajanje.

Pri uporabi integriranih pogonov, kot je ULN2804A, je vezje pogosto že prilagojeno za 5 V TTL komplementarnost:

- Rb označuje vhodno upornost ali prireditveni upor, ki zagotavlja kompatibilnost s 5 V TTL,
- dodatni upori R1 in R2 služijo hitrejši zapori tranzistorjev (pospešijo izklop skozi razbremenitev bazne kapacitete),
- D1 pa ščiti pred povratnimi napetostnimi sunki pri vklopu induktivnih bremen.

Čeprav v nekaterih primerih navajajo, da linearni upor ni potreben, je za določene aplikacije vseeno potreben izračun ustreznega upora (npr. za omejitev toka ali prilagoditev moči izgube), zato ga pri načrtovanju vključimo in preračunamo glede na napetosti, tok in zahteve obremenitve.

- [primer vezja(KiCAD) ](./circ/1_1_Darlingtom_open_collector_circ_withRb.png)

### Svetlobni senzorji

- delilnik napetosti
- izračun izhodne napetosti

$$ U_i = R_r I_r = R_r \frac{U_c}{R_r + R_{LDR}} $${#eq:izhodna_senzorja}

- pogoji za kompatibilnost s TTL digitalnimi vezji:
    - 0 = {-0.7V .. 0.6V}
    - 1 = [2.6V .. 5.25V]
    - vmesni interval .. ni definiran

- izračunajmo najprimernejši fotoupor:
    1. $U_1 = ...$
    2. $U_2 = ...$
    3. $\Delta U = ...$
    4. $\frac{\partial}{\partial R_r} \Delta U = ... = 0 (maximum)$
    5. $R_r(max \Delta U) = \sqrt{R_1 R_2}$

<!--
v wolframalpha:

- u_1 = r_0 * (u_0 /(r_0 + r_1))
- u_2 = r_0 * (u_0 /(r_0 + r_2))
- dU= r_0 * (u_0 /(r_0 + r_1)) - r_0 * (u_0 /(r_0 + r_2))
- derivate(r_0 * (u_0 /(r_0 + r_1)) - r_0 * (u_0 /(r_0 + r_2)),r_0)
- spremeni r_0 v x
- derivate(x * (u_0 /(x + r_1)) - x * (u_0 /(x + r_2)),x)
- če privzamemeo, da so x, u_0, r_1 in r_2 pozitivne vrednosti...
- solve(derivate(x * (u_0 /(x + r_1)) - x * (u_0 /(x + r_2)) , x) = 0 , x)
-->

- fototranzistor je počasen...
- namesto njega uporabimo:
    - fotodiodo ali
    - fototranzistor (pri fischertechnik kockah)
- fotodiodo vs fototranzizstor
    - v splošnem velja, da ima fotodioda hitrejši odziv od fototranzistorja,
    - a so tokovi skoznjo precej manjši (ima večjo upornost)

    - ni vedno tako, zato moramo vedno preveriti specifikacije elementov, lahko se izkaže, da sta elementa po specifikaciji zelo podobna:
        - [fototranzizstor LPT80A](https://search.datasheetcatalog.net/key/LPT80A)
        - [fotodioda BPW34](https://search.datasheetcatalog.net/key/BPW34)
        - 100lux = 1.5E-5 W/cm² = 1.5E-2 mW/cm² [pretvorba](https://www.unitsconverters.com/en/Lx-To-W/Cm3/Utu-3537-3547)

- Zato moramo uporabiti tokovno-napetostni pretvornik:
  - prenosna funkcija je: Uout=Itr *  Rref
    - izpeljemo jo preko sumacijske točke na invertirajočem vhodu.
  - iz grafa na sliki 5 za [foto-diodo BPW34](https://www.vishay.com/docs/81521/bpw34.pdf) lahko ugotovimo, da bo pri osvetljenosti 0.2 mW/cm2 tekel skozi fotodiodo tok I=10uA in to ne glede na napetost, ki jo priključimo nanjo.
  - To pomeni, da če tokovno-napetostnemu pretvorniku dodamo referenčni upor 470 kOhm, bomo na njegovem izhodu dobili 4,7V.

## To-do
- Uporaba operacijskega ojačevalnika kot komparatorja napetosti
- Komparatorji napetosti z odprtim kolektorjem
- Schmittov sprožilnik
- digitalni Schmittov sprožilnik 
- Optični spojniki 

